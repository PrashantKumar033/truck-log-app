<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gas Plant Truck Log</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Mobile Navigation -->
  <div class="mobile-nav">
    <h1>ğŸšš Truck Log</h1>
    <button class="nav-toggle" onclick="toggleNav()">â˜°</button>
  </div>
  
  <!-- Sidebar Navigation -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h3>ğŸšš Menu</h3>
      <button class="close-btn" onclick="toggleNav()">Ã—</button>
    </div>
    <div class="nav-links">
      <a href="#" onclick="showSection('entries')">ğŸ“‹ Entries</a>
      <a href="#" onclick="showSection('transports')">ğŸš› Transports</a>
      <a href="#" onclick="showSection('summary')">ğŸ“Š Summary</a>
      <a href="#" onclick="logout()">ğŸšª Logout</a>
    </div>
    <div id="userInfo" style="padding: 15px; border-top: 1px solid #ddd; margin-top: auto;">
      <span id="welcomeText"></span>
    </div>
  </div>
  
  <!-- Overlay -->
  <div class="overlay" id="overlay" onclick="toggleNav()"></div>
  
  <!-- Desktop Header -->
  <div class="desktop-header">
    <h1>ğŸšš Gas Plant Truck Log</h1>
    <div id="userInfoDesktop" style="display: none;">
      <span id="welcomeTextDesktop"></span>
      <button onclick="logout()" style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; margin-left: 10px;">Logout</button>
    </div>
  </div>
  
  <!-- Desktop Navigation Tabs -->
  <div class="desktop-nav-tabs">
    <button class="nav-tab active" onclick="showSection('entries')">ğŸ“‹ Entries</button>
    <button class="nav-tab" onclick="showSection('transports')">ğŸš› Transports</button>
    <button class="nav-tab" onclick="showSection('summary')">ğŸ“Š Summary</button>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    
    <!-- Entries Section -->
    <div id="entriesSection" class="section active">
      <div class="card">
        <h3>ğŸšš New Entry</h3>
        <form id="entryForm">
          <label for="date">Date *</label>
          <input type="date" id="date" required style="cursor: pointer; position: relative;">
          
          <label for="truckNo">Truck Number *</label>
          <input type="text" id="truckNo" placeholder="Enter truck number" required>
          
          <label for="transportName">Transport Name</label>
          <div class="transport-input-container">
            <input type="text" id="transportName" placeholder="Enter transport name" autocomplete="off">
            <div class="transport-dropdown" id="transportDropdown"></div>
          </div>
          
          <label for="loadLocation">Load Location *</label>
          <input type="text" id="loadLocation" placeholder="Enter load location" required>
          
          <label for="dieselLiters">Diesel (Liters) *</label>
          <input type="number" id="dieselLiters" placeholder="Enter diesel amount" required>
          
          <label for="amountPaid">Amount Paid (â‚¹) *</label>
          <input type="number" id="amountPaid" placeholder="Enter amount paid" required>
          
          <label for="labourCost">Labour Cost (â‚¹)</label>
          <input type="number" id="labourCost" placeholder="Enter labour cost">
          
          <label for="notes">Notes</label>
          <input type="text" id="notes" placeholder="Additional notes (optional)">
          
          <button type="submit">ğŸ’¾ Save Entry</button>
        </form>
      </div>

      <div class="card">
        <h3>ğŸ” Filter & Summary</h3>
        
        <label for="from">From Date</label>
        <input type="date" id="from">
        
        <label for="to">To Date</label>
        <input type="date" id="to">
        
        <div class="filter-buttons">
          <button onclick="loadEntries()">ğŸ“… Load by Date Range</button>
        </div>
        
        <label for="month">Select Month</label>
        <input type="month" id="month">
        
        <div class="filter-buttons">
          <button onclick="loadMonth()">ğŸ“† Load by Month</button>
        </div>
        
        <div class="filter-buttons">
          <button onclick="clearFiltersAndLoad()" style="background: #28a745;">ğŸ”„ Load All Entries</button>
        </div>
        
        <div id="summary"></div>
      </div>

      <!-- Mobile Card View -->
      <div class="entry-cards" id="entryCards">
        <!-- Cards will be populated here -->
      </div>

      <!-- Desktop Table View -->
      <div class="card desktop-only">
        <h3>ğŸ“‹ Entries</h3>
        <table id="table">
          <thead>
            <tr><th>Date</th><th>Truck No</th><th>Transport</th><th>Load</th><th>Diesel</th><th>Amount</th><th>Labour</th><th>Notes</th><th>Actions</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    
    <!-- Transports Section -->
    <div id="transportsSection" class="section">
      <div class="card">
        <h3>ğŸš› Add Transport</h3>
        <form id="transportForm">
          <label for="transportNameAdd">Transport Name *</label>
          <input type="text" id="transportNameAdd" placeholder="Enter transport name" required>
          
          <label for="transportLocation">Location</label>
          <input type="text" id="transportLocation" placeholder="Enter transport location">
          
          <label for="dieselRate">Diesel (Liters)</label>
          <input type="number" id="dieselRate" placeholder="Enter diesel liters required for this location">
          
          <label for="transportRate">Transport Rate (â‚¹)</label>
          <input type="number" id="transportRate" placeholder="Enter transport rate">
          
          <label for="labourCostDefault">Default Labour Cost (â‚¹)</label>
          <input type="number" id="labourCostDefault" placeholder="Enter default labour cost">
          
          <button type="submit">ğŸ’¾ Add Transport</button>
        </form>
      </div>
      
      <div class="card">
        <h3>ğŸš› All Transports</h3>
        
        <label for="transportSearch">ğŸ” Search Transports</label>
        <input type="text" id="transportSearch" placeholder="Search by name or location..." style="margin-bottom: 15px;">
        
        <div id="transportsList"></div>
      </div>
    </div>
    
    <!-- Summary Section -->
    <div id="summarySection" class="section">
      <div class="card">
        <h3>ğŸ“Š Summary</h3>
        <div id="detailedSummary"></div>
      </div>
    </div>
    
  </div>

<script>
// Check if user is logged in, redirect to login if not
if (!localStorage.getItem('sessionId') || !localStorage.getItem('user')) {
  window.location.href = '/login.html';
}

// Navigation functions
function toggleNav() {
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('overlay');
  sidebar.classList.toggle('active');
  overlay.classList.toggle('active');
}

function showSection(sectionName) {
  // Hide all sections
  document.querySelectorAll('.section').forEach(section => {
    section.classList.remove('active');
  });
  
  // Show selected section
  document.getElementById(sectionName + 'Section').classList.add('active');
  
  // Close mobile nav
  toggleNav();
  
  // Load data for the section
  if (sectionName === 'entries') {
    loadEntries();
    loadTransportsList();
  } else if (sectionName === 'transports') {
    loadTransports();
  } else if (sectionName === 'summary') {
    loadDetailedSummary();
  }
}

// Initialize on load
window.addEventListener('load', () => {
  showSection('entries');
});
</script>
<script src="script-clean.js"></script>
</body>
</html>
